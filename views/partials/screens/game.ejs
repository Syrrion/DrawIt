<!-- Game Screen -->
<div id="game-screen" class="screen hidden">
    <!-- Top Bar -->
    <div id="game-top-bar" class="game-top-bar hidden">
        <div class="timer-display">
            <i class="fas fa-clock"></i> <span id="timer-value">0</span>
        </div>
        <div class="word-display-container" style="display:flex; align-items:center; gap:15px;">
            <div class="word-display" id="word-display">
                _ _ _ _ _
            </div>
            <button id="btn-use-hint" class="hint-btn hidden" title="Utiliser un indice (20s cooldown)">
                <i class="fas fa-lightbulb"></i> <span id="hints-count">3</span>
            </button>
        </div>
        <div class="round-info">
            Round <span id="round-current">1</span>/<span id="round-total">3</span>
        </div>
    </div>

    <%- include('../modals/word-choice') %>
    <%- include('../modals/round-result') %>
    <%- include('../modals/game-end') %>
    <%- include('../modals/ready-check') %>
    <%- include('../modals/lobby-settings') %>
    <%- include('../modals/user-settings') %>

    <div class="sidebar">
        <div class="room-info">
            <h3>Room <span id="room-privacy-badge" class="privacy-badge"></span></h3>
            <div class="room-code-wrapper">
                <span id="display-room-code" class="code-hidden"></span>
                <div class="room-actions">
                    <button id="toggle-code-btn" title="Afficher/Masquer">
                        <svg id="icon-eye" viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>
                        <svg id="icon-eye-off" class="hidden" viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path><line x1="1" y1="1" x2="23" y2="23"></line></svg>
                    </button>
                    <button id="copy-code-btn" title="Copier le code">
                        <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>
        </div>
        
        <div class="players-header">
            <h3>Joueurs <span id="player-count-display" style="font-size: 0.8rem; color: var(--text-dim); margin-left: 5px;"></span></h3>
        </div>

        <div id="players-list" class="players-list">
            <!-- Players will be added here -->
        </div>
        
        <div class="layers-panel">
            <div class="layers-header">
                <h3>Calques</h3>
                <button id="add-layer-btn" title="Nouveau calque">
                    <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
                </button>
            </div>
            <div id="layers-list" class="layers-list">
                <!-- Layers will be added here -->
            </div>
        </div>
        
        <div class="sidebar-footer">
            <div id="lobby-controls" class="hidden">
                <button id="btn-open-settings" class="btn-primary full-width hidden">
                    <i class="fas fa-cog"></i> Commencer une partie
                </button>
                <button id="btn-view-settings" class="settings-btn hidden">
                    <i class="fas fa-cog"></i> PARAMÈTRES DE PARTIE
                </button>
                <div id="waiting-message" class="waiting-status hidden">
                    <i class="fas fa-hourglass-half"></i>
                    <span>En attente du leader...</span>
                </div>
            </div>
            <button id="btn-user-settings" class="settings-btn">
                <i class="fas fa-user-cog"></i> Paramètres
            </button>
        </div>
    </div>
    
    <div class="main-area">
        <div class="canvas-container" id="canvas-container">
            <div class="canvas-wrapper" style="position: relative;">
                <canvas id="drawing-board"></canvas>
                <div id="cursors-layer"></div>
            </div>
            <div id="zoom-overlay" class="zoom-overlay hidden">100%</div>
        </div>

        <div class="toolbar">
            <!-- Properties Group (Color + Sliders) -->
            <div class="tool-group properties-group">
                <div class="color-picker-wrapper" title="Couleur">
                    <div class="color-trigger" id="color-trigger">
                        <div id="current-color-preview"></div>
                    </div>
                </div>
                
                <div class="sliders-compact">
                    <div class="slider-row" data-tooltip="Taille">
                        <div class="slider-icon"><i class="fas fa-circle" style="font-size: 0.6rem;"></i></div>
                        <input type="range" id="pen-size" min="1" max="100" value="5">
                    </div>
                    <div class="slider-row" data-tooltip="Opacité">
                        <div class="slider-icon"><i class="fas fa-adjust" style="font-size: 0.8rem;"></i></div>
                        <input type="range" id="pen-opacity" min="0.1" max="1" step="0.1" value="1">
                    </div>
                </div>
            </div>

            <!-- Drawing Tools Group -->
            <div class="tool-group">
                <button id="tool-pen" class="tool-btn active" data-tooltip="Crayon (1)">
                    <svg viewBox="0 0 24 24" width="20" height="20" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path></svg>
                </button>
                <button id="tool-airbrush" class="tool-btn" data-tooltip="Spray (2)">
                    <svg viewBox="0 0 24 24" width="20" height="20" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><rect x="6" y="8" width="12" height="13" rx="2"></rect><path d="M15 8V4a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v4"></path><path d="M12 3v1"></path><path d="M10 12h.01"></path><path d="M14 12h.01"></path><path d="M12 15h.01"></path><path d="M10 17h.01"></path><path d="M14 17h.01"></path></svg>
                </button>
                <button id="tool-fill" class="tool-btn" data-tooltip="Remplir (3)">
                    <svg viewBox="0 0 24 24" width="20" height="20" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round">
                        <rect x="4" y="4" width="16" height="6" rx="1"></rect>
                        <path d="M18 10v3a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2v-3"></path>
                        <path d="M12 15v6"></path>
                    </svg>
                </button>
                <button id="tool-smudge" class="tool-btn" data-tooltip="Doigt (4)">
                    <svg viewBox="0 0 24 24" width="20" height="20" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M18 11V6a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v0"></path>
                        <path d="M14 10V4a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v2"></path>
                        <path d="M10 10.5V6a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v8"></path>
                        <path d="M18 8a2 2 0 1 1 4 0v6a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15"></path>
                    </svg>
                </button>
                <button id="tool-eraser" class="tool-btn" data-tooltip="Gomme (5)">
                    <svg viewBox="0 0 24 24" width="20" height="20" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M15.5 3.5 L20.5 8.5 L8.5 20.5 L3.5 15.5 Z"></path>
                        <line x1="11" y1="8" x2="16" y2="13"></line>
                    </svg>
                </button>
                <button id="tool-pipette" class="tool-btn" data-tooltip="Pipette (6)">
                    <svg viewBox="0 0 24 24" width="20" height="20" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M2 22l5-1.5L15.5 12l3-3a2.828 2.828 0 1 0-4-4l-3 3L3.5 17 2 22z"></path>
                        <path d="M13 9l4 4"></path>
                    </svg>
                </button>
                <button id="tool-selection" class="tool-btn" data-tooltip="Sélection (7)">
                    <svg viewBox="0 0 24 24" width="20" height="20" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round">
                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2" stroke-dasharray="4 4"></rect>
                    </svg>
                </button>
                
                <!-- Separator -->
                <div class="tool-separator"></div>

                <!-- Shapes -->
                <button id="tool-rect" class="tool-btn" data-tooltip="Carré (8)">
                    <svg viewBox="0 0 24 24" width="20" height="20" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect></svg>
                </button>
                <button id="tool-circle" class="tool-btn" data-tooltip="Cercle (9)">
                    <svg viewBox="0 0 24 24" width="20" height="20" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle></svg>
                </button>
                <button id="tool-triangle" class="tool-btn" data-tooltip="Triangle (0)">
                    <svg viewBox="0 0 24 24" width="20" height="20" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path></svg>
                </button>
                <button id="tool-line" class="tool-btn" data-tooltip="Trait (-)">
                    <svg viewBox="0 0 24 24" width="20" height="20" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><line x1="5" y1="19" x2="19" y2="5"></line></svg>
                </button>
            </div>

            <!-- Actions Group -->
            <div class="tool-group">
                <button id="btn-undo" class="tool-btn" data-tooltip="Annuler (Ctrl+Z)">
                    <svg viewBox="0 0 24 24" width="20" height="20" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><path d="M3 7v6h6"></path><path d="M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13"></path></svg>
                </button>
                <button id="btn-redo" class="tool-btn" data-tooltip="Rétablir (Ctrl+Y)">
                    <svg viewBox="0 0 24 24" width="20" height="20" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><path d="M21 7v6h-6"></path><path d="M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3L21 13"></path></svg>
                </button>
                <button id="clear-btn" class="danger-btn" data-tooltip="Tout effacer">
                    <svg viewBox="0 0 24 24" width="20" height="20" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>
                </button>
                <button id="btn-help" class="tool-btn" data-tooltip="Aide">
                    <svg viewBox="0 0 24 24" width="20" height="20" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
                </button>
            </div>
        </div>
    </div>

    <div class="chat-sidebar">
        <div class="chat-header">
            <h3>Chat</h3>
        </div>
        <div id="chat-messages" class="chat-messages">
            <!-- Messages will appear here -->
        </div>
        <form id="chat-form" class="chat-form">
            <input type="text" id="chat-input" placeholder="Ecrire un message" autocomplete="off">
            <button type="submit" title="Envoyer">
                <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
            </button>
        </form>
    </div>
</div>